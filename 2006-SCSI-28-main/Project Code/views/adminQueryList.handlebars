<section class="py-4">
  <div class="container">
    <div class="bb-hero-card bg-success-subtle rounded-3 p-4 p-md-5">
      
      <div class="row align-items-center g-4 mb-4">
        <div class="col-lg-8 mx-auto text-center">
          <h1 class="display-6 mb-3 text-success">
            <i class="bi bi-chat-dots me-2"></i>All User Queries
          </h1>
          <p class="lead mb-0">
            View all submitted questions and respond to them.
          </p>
        </div>
      </div>

      <div class="row mt-5">
        <div class="col-12 text-center">

    <div class="me-3 d-inline-block">
    <form method="GET" action="/adminQuery/Dashboard/queryList" class="d-inline-block">
        <label for="statusFilter" class="form-label fw-bold me-2">Filter:</label>
        <select name="status" id="statusFilter" class="form-select d-inline-block w-auto" onchange="this.form.submit()">
        <option value="">All</option>
        <option value="Answered" {{#if (eq selectedStatus "Answered")}}selected{{/if}}>Answered</option>
        <option value="Pending" {{#if (eq selectedStatus "Pending")}}selected{{/if}}>Pending</option>
        </select>
    </form>
    </div>

          <a href="/adminQuery/Dashboard" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left me-2"></i>Back to Dashboard
          </a>
          <br><br>
        </div>
      </div>

      {{#if queries.length}}
        <div class="row g-4">
          {{#each queries}}
            <div class="col-12">
              <div class="card border-0 shadow-sm">
                <div class="card-body p-4">
                  <div class="row">
                    <div class="col-md-8">
                      <div class="d-flex align-items-start mb-3">
                        <div class="me-3">
                          <i class="bi bi-question-circle-fill text-success" style="font-size: 1.5rem;"></i>
                        </div>
                        <div class="flex-grow-1">
                          <h5 class="card-title mb-2">{{question}}</h5>
                          <p class="text-muted small mb-2">
                            <i class="bi bi-calendar-event me-1"></i>Created: {{createdAt}}
                          </p>
                        </div>
                      </div>
                      
                      {{#if answer}}
                        <div class="border-start border-3 border-success ps-3 mt-3">
                          <h6 class="text-success mb-2">
                            <i class="bi bi-chat-right-text me-1"></i>Answer:
                          </h6>
                          <p class="mb-0">{{answer}}</p>
                        </div>
                      {{else}}
                        <div class="border-start border-3 border-warning ps-3 mt-3">
                          <p class="text-muted mb-0">
                            <i class="bi bi-hourglass me-1"></i>Waiting for response...
                          </p>
                          <form action="/adminQuery/Dashboard/queryRespond/{{_id}}" method="POST" class="mt-3">
                            <div class="mb-3">
                              <textarea 
                                name="responseText" 
                                class="form-control" 
                                rows="4" 
                                placeholder="Type your response here..." 
                                required></textarea>
                            </div>
                            <button type="submit" class="btn btn-success">
                              <i class="bi bi-send-fill me-1"></i>Respond
                            </button>
                          </form>
                        </div>
                      {{/if}}
                    </div>   
                    <div class="col-md-4 text-md-end">
                      <span class="badge {{#if answer}}bg-success{{else}}bg-warning{{/if}} fs-6">
                        <i class="bi {{#if answer}}bi-check-circle{{else}}bi-clock{{/if}} me-1"></i>
                        {{#if answer}}Answered{{else}}Pending{{/if}}
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          {{/each}}
        </div>
      {{else}}
        <div class="text-center py-5">
          <div class="mb-4">
            <i class="bi bi-chat-square-dots text-muted" style="font-size: 4rem;"></i>
          </div>
          <h3 class="text-muted mb-3">No Queries Yet</h3>
          <p class="text-muted mb-4">No query is submitted by users. </p>
          <a href="/query/new" class="btn btn-success btn-lg">
            <i class="bi bi-plus-circle me-2"></i> Wait for new Queries
          </a>
        </div>
      {{/if}}
    </div>
  </div>
</section>
